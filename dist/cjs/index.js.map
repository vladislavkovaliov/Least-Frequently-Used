{"version":3,"file":"index.js","sources":["../../src/index.ts"],"sourcesContent":["export class LFUCache {\n    private cache: Map<number, Record<string, number>>;\n    private frequencies: Map<number, Set<number>>;\n    private minFrequency: number;\n    private capacity: number;\n\n    constructor(capacity: number) {\n        this.cache       = new Map();\n        this.frequencies = new Map();\n\n        this.minFrequency = 1;\n        this.capacity     = capacity;\n    }\n\n    get(key: number): number {\n        if(!this.cache.has(key)) {\n            return -1;\n        }\n        \n        const record = this.cache.get(key);\n        \n        if (!record) {\n            return -1;\n        }\n\n        record.frequency = record.frequency + 1;\n        this.updateFrequency(record.frequency, key);\n    \n        return record.value;\n    }\n\n    updateFrequency(frequencyKey: number, key: number) {\n        const oldFr = frequencyKey - 1;\n        const oldSet = this.frequencies.get(oldFr);\n        \n        if (oldSet) {\n            oldSet.delete(key);\n        }\n        \n        if (this.frequencies.has(frequencyKey)) {\n            const frequency = this.frequencies.get(frequencyKey);\n\n            if (frequency) {\n                frequency.add(key);\n            }\n        } else {\n            this.frequencies.set(frequencyKey, (new Set<number>()).add(key));\n        }\n        \n        if (frequencyKey < this.minFrequency || (oldSet && !oldSet.size && oldFr === this.minFrequency)) {\n            this.minFrequency = frequencyKey;\n        }\n    }\n\n    put(key: number, value: number): void {\n        if (this.capacity === 0) {\n            return;\n        }\n\n        if (this.cache.has(key)) {\n            const record = this.cache.get(key);\n            \n            if (!record) {\n                return;\n            }\n\n            record.frequency = record.frequency + 1;\n            record.value = value;\n            \n            this.updateFrequency(record.frequency, key);\n        } else {\n             if (this.cache.size === this.capacity) {       \n                const frequency = this.frequencies.get(this.minFrequency);\n                \n                if (!frequency) {\n                    return;\n                }\n                \n                const [firstKey] = frequency.values();\n                \n                this.cache.delete(firstKey);\n                frequency.delete(firstKey);\n                this.minFrequency = 1;\n            }\n            this.cache.set(key, { value: value, frequency: 1 });\n            this.updateFrequency(1, key);\n        }\n    }\n}"],"names":[],"mappings":"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"}